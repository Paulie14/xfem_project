\documentclass[10pt, xcolor=dvipsnames]{beamer} %[handout,red]
\usepackage{amsmath}
\usepackage{graphicx,multimedia,hyperref,xmpmulti}
\usepackage[utf8]{inputenc}
\usepackage[czech]{babel}

% Templating stuff
% \beamertemplatetransparentcovereddynamic
%\colorlet{averagebackgroundcolor}{white}
\setbeamertemplate{itemize items}[circle]
\setbeamertemplate{enumerate items}[square]
\setbeamertemplate{section in toc}[square]
\setbeamercolor*{block title}{fg=white,bg=structure!75!black}
\setbeamercolor*{block body}{bg=structure!10!averagebackgroundcolor}

%\setbeamercolor*{block title example}{fg=white,bg=beamerexample!75!black}
%\setbeamercolor*{block body example}{bg=beamerexample!10!averagebackgroundcolor}
% \usepackage{beamerthemeshadow}
%\setbeamertemplate{background canvas}{\includegraphics [width=0.3\paperwidth]{logo-cxi-cmyk-cz.pdf}}


\setbeamertemplate{footline}{\includegraphics[width=\paperwidth]{../logos/fm_spojovaci.pdf}

\vspace{-2.7mm}

\hspace{5mm}{\bf\inserttitle~ \textcolor{structure}{$\boldsymbol{|}$} \insertdate}

\vspace{-3.5mm}

\hspace{\stretch{1}} \textcolor{white}{\insertframenumber/\inserttotalframenumber} \hspace{2mm}

\vspace{3mm}
}

\definecolor{cxi}{RGB}{193,10,43}
%\definecolor{fm}{RGB}{238,127,0}
%\definecolor{fm}{cmyk}{0.0, 0.563, 1.0, 0.129}
\definecolor{fm}{HTML}{DE6100}
\definecolor{mycolor}{HTML}{00CC00}
%\setbeamercolor{structure}{fg=cxi}
\setbeamercolor{structure}{fg=fm}
\setbeamertemplate{frametitle}{\begin{flushleft}\bf\large\insertframetitle\end{flushleft}\par}
\beamertemplateheadempty
\beamertemplatenavigationsymbolsempty
\beamertemplateshadowblocks

\renewcommand{\titlepage}{
{\bf\Large\inserttitle}\\\vspace{3mm}\textit{\insertauthor~ \textcolor{structure}{$\boldsymbol{|}$} \insertdate}

\vspace{1.5cm}

\textcolor{structure}{$\boldsymbol{\star}$}~{\bf\large doctoral seminar}
}

% % uncomment if you want outline after each frame
% \AtBeginSection[]
% {
% \frame{\frametitle{Outline}
%   \tableofcontents[currentsection]
% }
% \addtocounter{framenumber}{-1} 
% }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5
% ***************************************** SYMBOLS
\def\div{{\rm div}}
\def\Lapl{\Delta}
\def\grad{\nabla}
\def\supp{{\rm supp}}
\def\dist{{\rm dist}}
%\def\chset{\mathbbm{1}}
\def\chset{1}

\def\Tr{{\rm Tr}}
\def\sgn{{\rm sgn}}
\def\to{\rightarrow}
\def\weakto{\rightharpoonup}
\def\imbed{\hookrightarrow}
\def\cimbed{\subset\subset}
\def\range{{\mathcal R}}
\def\leprox{\lesssim}
\def\argdot{{\hspace{0.18em}\cdot\hspace{0.18em}}}
\def\Distr{{\mathcal D}}
\def\calK{{\mathcal K}}
\def\FromTo{|\rightarrow}
\def\convol{\star}
\def\impl{\Rightarrow}
\DeclareMathOperator*{\esslim}{esslim}
\DeclareMathOperator*{\esssup}{ess\,sup}
\DeclareMathOperator{\ess}{ess}
\DeclareMathOperator{\osc}{osc}
\DeclareMathOperator{\curl}{curl}

%\def\Ess{{\rm ess}}
%\def\Exp{{\rm exp}}
%\def\Implies{\Longrightarrow}
%\def\Equiv{\Longleftrightarrow}
% ****************************************** GENERAL MATH NOTATION
\def\Real{{\rm\bf R}}
\def\Rd{{{\rm\bf R}^{\rm 3}}}
\def\RN{{{\rm\bf R}^N}}
\def\D{{\mathbb D}}
\def\Nnum{{\mathbb N}}
\def\Measures{{\mathcal M}}
\def\d{\,{\rm d}}               % differential
\def\sdodt{\genfrac{}{}{}{1}{\rm d}{{\rm d}t}}
\def\dodt{\genfrac{}{}{}{}{\rm d}{{\rm d}t}}

\def\vc#1{\mathbf{\boldsymbol{#1}}}     % vector
\def\tn#1{{\mathbb{#1}}}    % tensor
\def\abs#1{\lvert#1\rvert}
\def\Abs#1{\bigl\lvert#1\bigr\rvert}
\def\bigabs#1{\bigl\lvert#1\bigr\rvert}
\def\Bigabs#1{\Big\lvert#1\Big\rvert}
\def\ABS#1{\left\lvert#1\right\rvert}
\def\norm#1{\bigl\Vert#1\bigr\Vert} %norm
\def\close#1{\overline{#1}}
\def\inter#1{#1^\circ}
\def\ol#1{\overline{#1}}
\def\ul#1{\underline{#1}}
\def\eqdef{\mathrel{\mathop:}=}     % defining equivalence
\def\where{\,|\,}                    % "where" separator in set's defs
\def\timeD#1{\dot{\overline{{#1}}}}

% ******************************************* USEFULL MACROS
\def\RomanEnum{\renewcommand{\labelenumi}{\rm (\roman{enumi})}}   % enumerate by roman numbers
\def\rf#1{(\ref{#1})}                                             % ref. shortcut
\def\prtl{\partial}                                        % partial deriv.
\def\Names#1{{\scshape #1}}
\def\rem#1{{\parskip=0cm\par!! {\sl\small #1} !!}}

\def\Xint#1{\mathchoice
{\XXint\displaystyle\textstyle{#1}}%
{\XXint\textstyle\scriptstyle{#1}}%
{\XXint\scriptstyle\scriptscriptstyle{#1}}%
{\XXint\scriptscriptstyle\scriptscriptstyle{#1}}%
\!\int}
\def\XXint#1#2#3{{\setbox0=\hbox{$#1{#2#3}{\int}$}
\vcenter{\hbox{$#2#3$}}\kern-.5\wd0}}
\def\ddashint{\Xint=}
\def\dashint{\Xint-}

% ******************************************* DOCUMENT NOTATIONS
% document specific
\def\rh{\varrho}
\def\vl{{\vc{u}}}
\def\th{\vartheta}
\def\vx{\vc{x}}
\def\vX{\vc{X}}
\def\vr{\vc{r}}
\def\veta{\vc{\eta}}
\def\dx{\,\d\vx}
\def\dt{\,\d t}
\def\bulk{\zeta}
\def\cS{\close{S}}
\def\eps{\varepsilon}
\def\phi{\varphi}
\def\Bog{{\mathcal B}}
\def\Riesz{{\mathcal R}}
\def\distr{\mathcal D}
\def\Item{$\bullet$}

\def\MEtst{\mathcal T}
%***************************************************************************
\setbeamercolor{my blue}{fg=blue}
\def\blue#1{{\usebeamercolor[fg]{my blue} #1}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%MY:

%TABLE
\usepackage{colortbl} %colored table
\usepackage{hhline} %double hlines
\usepackage{array}
\usepackage{booktabs}
\usepackage{subfig}

\newcommand{\figpath}{../graphics/}
\newcommand{\results}{results/}
\usepackage{amsmath, amsthm, amssymb}
\usepackage{mathtools}

%DATES:
\newcommand{\dst}{\textsuperscript{st}}
\newcommand{\dnd}{\textsuperscript{nd}}
\newcommand{\drd}{\textsuperscript{rd}}
\newcommand{\dth}{\textsuperscript{th}}

%COLORFUL UNDERLINE
\newcommand{\rul}[2]{\textcolor{#1}{\underline{\textcolor{black}{#2}}}}

%FONT SIZES available:
%     \tiny
%     \scriptsize
%     \footnotesize
%     \small
%     \normalsize
%     \large
%     \Large
%     \LARGE
%     \huge
%     \Huge 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5

% SETTING TITLE PAGE MEMBERS
\title{Partition of unity methods for approximation of point water sources in porous media}
\author{Pavel Exner, Jan Březina}
\institute{TECHNICAL UNIVERSITY OF LIBEREC}
\date{5\dth February 2014}


\begin{document}


% { %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%   CZECH TITLEPAGE   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%   \setbeamertemplate{background canvas}{\includegraphics [width=0.5\paperwidth]{logos/logo-cxi-cmyk-cz.pdf}}
%   \setbeamertemplate{footline}{\includegraphics[width=\paperwidth]{logos/cxi-spojovaci.png}
% 
%     \vspace{-6mm}
% 
%     \hspace{9mm}
%     %{\bf TECHNICKÁ UNIVERZITA V LIBERCI \textcolor{structure}{$\boldsymbol{|}$ Ústav pro nanomateriály, pokročilé technologie a inovace}}
%     Studentská 1402/2 \textcolor{structure}{$\boldsymbol{|}$} 461 17 Liberec 1 \textcolor{structure}{$\boldsymbol{|}$} www.cxi.tul.cz
% 
%     \vspace{-3.1mm}
% 
%     \hspace{\stretch{1}} \textcolor{white}{\insertframenumber/\inserttotalframenumber} \hspace{2mm}
% 
%     \vspace{3mm}
%     }
%   \frame{
% 	\vspace{1cm}
% 	\titlepage
%   }
% } %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%   END CZECH TITLEPAGE   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 
{ %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%   ENGLISH TITLEPAGE   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  \setbeamertemplate{background canvas}
  {
    \hspace{5mm}
    \includegraphics [width=0.5\paperwidth]{../logos/logo-fm-cmyk-en.pdf}
  }
  \setbeamertemplate{footline}{\includegraphics[width=\paperwidth]{../logos/fm_spojovaci.pdf}

    \vspace{-2.3mm}

    \hspace{9mm}
    %{\bf TECHNICAL UNIVERSITY OF LIBEREC \textcolor{structure}{$\boldsymbol{|}$ Institue for Nanomaterials, Advanced Technologies and Innovation}}
    %Studentská 1402/2 \textcolor{structure}{$\boldsymbol{|}$} 461 17 Liberec 1 \textcolor{structure}{$\boldsymbol{|}$} www.cxi.tul.cz
    Studentská 1402/2 \textcolor{structure}{$\boldsymbol{|}$} 461 17 Liberec 1 \textcolor{structure}{$\boldsymbol{|}$} www.fm.tul.cz

    \vspace{-3.5mm}

    \hspace{\stretch{1}} \textcolor{white}{\insertframenumber/\inserttotalframenumber} \hspace{2mm}

    \vspace{3mm}
    }
  \frame{
    \vspace{1cm}
    \titlepage
  }
} %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  END ENGLISH TITLEPAGE   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


 \begin{frame}
   \frametitle{Outline}
   \tableofcontents
   \addtocounter{framenumber}{-1} 
 \end{frame}


\section{Introduction}
% \begin{frame}
%   \frametitle{Motivation}
%   
%   \begin{itemize}
%   \setlength{\itemsep}{18pt}
%     \item problems in FE (finite element) models
%     \begin{itemize}
%       \item cracks in material
%       \item quantity interfaces, membrane model
%       \item {\bf point sources -- fluid flow}, heat flow, electrostatics
%     \end{itemize}
%     \item local refinement of a mesh can be difficult and leads to large computational costs
%     \item local character of the solution can be known \newline  
%           $\rightarrow$ using FE shape functions as PU (Partition of Unity) method we 
%           can incorporate the known information into FE solution
%     \item model based on
%           \newline 
%           \small{ \newline R. Gracie, J.R. Craig, \emph{Modelling well leakage in multilayer aquifer systems using the extended finite element method}. 2010}
%   \end{itemize}
% \end{frame}
% 
% \begin{frame}
%   \hspace{-3pt}
%   \begin{minipage}{0.32\linewidth}
%     \includegraphics[width=\linewidth]{\figpath pole_drilling_rig.jpg}
%   \end{minipage}
%   \begin{minipage}{0.32\linewidth}
%     \includegraphics[width=\textwidth]{\figpath indian_bore_well.jpg}
%   \end{minipage}
%   \begin{minipage}{0.32\linewidth}
%     \includegraphics[width=\textwidth]{\figpath wishing_well.jpg}
%   \end{minipage}
% \end{frame}



\begin{frame}
  \frametitle{Motivation}
  problems in FE (finite element) models:
    \begin{itemize}
      \item cracks in material
      \item quantity interfaces, membrane model
      \item {\bf point sources -- fluid flow}, heat flow, electrostatics
    \end{itemize}
  
  \pause
  \hspace{-3pt}
  \begin{minipage}{0.32\linewidth}
    \includegraphics[width=\linewidth]{\figpath pole_drilling_rig.jpg}
  \end{minipage}
  \begin{minipage}{0.32\linewidth}
    \includegraphics[width=\textwidth]{\figpath indian_bore_well.jpg}
  \end{minipage}
  \begin{minipage}{0.32\linewidth}
    \includegraphics[width=\textwidth]{\figpath wishing_well.jpg}
  \end{minipage}
\end{frame}


\begin{frame}
  \frametitle{Motivation -- solution}
  
  \begin{itemize}
  \setlength{\itemsep}{18pt}
    \item<1-> local refinement of a mesh can be difficult and leads to large computational costs

    \item<2-> local character of the solution can be known \newline  
          $\rightarrow$ using FE shape functions as PU (Partition of Unity) method we 
          can incorporate the known information into FE solution
          
          \begin{minipage}{0.45\textwidth}
            \begin{equation*}
              {\color{red}PU:} \quad  \sum \limits_{i\in\mathcal{N}} \phi_i(\mathbf{x})=1
            \end{equation*}
          \end{minipage}
          ~
          \begin{minipage}{0.45\textwidth}
            \vspace{5pt}
            \includegraphics[width=\textwidth]{\figpath Fries_CorrXFEM_PU.pdf}
          \end{minipage}
          %
    \item<2-> \vspace{-0.5cm} model based on
          \newline 
          \small{ \newline R. Gracie, J.R. Craig, \emph{Modelling well leakage in multilayer aquifer systems using the extended finite element method}. 2010}
  \end{itemize}
  
  \begin{overlayarea}{\linewidth}{8cm}
  \onslide<1>
    {
        \vspace{-6.5cm}
        %\begin{minipage}{\linewidth}
        \centering 
        \includegraphics[width=0.6\textwidth]{\figpath adaptive_mesh.pdf}
        %\end{minipage}  
    }
  \end{overlayarea}
\end{frame}


\section{Model of flow}
\begin{frame}
  \frametitle{Model of pressure in a multi-aquifer system}
   \begin{columns}
    \column{0.48\textwidth}
        \includegraphics[width=45mm]{\figpath model.pdf}
        
        Darcy's law and continuity eq.:
        \begin{eqnarray*}
            \mathbf{u}=-\mathbf{T}\nabla h \label{eqn:1}\\ 
        %\end{equation*}
        %Rovnice kontinuity 
        %\begin{equation*}
            \nabla \cdot \mathbf{u} = f  \label{eqn:2} 
        \end{eqnarray*}
        
        $\Omega^m \subset \mathbb{R}^2$ -- $m$-th aquifer
        
        $B_w^m$ -- cross-section of the well $w$ and aquifer $m$

        $\Theta^m=\Omega^m-\bigcup \limits _{w=1}^{W} B^m_w$
        %
    \column{0.48\textwidth}
        $\rightarrow$ Poisson equation:
        \begin{equation} 
            \color{red}{-T^m\Delta{}h^m=f^m  \qquad \textrm{in } \Theta^m}
        \end{equation} %
    %
        boundary conditions:
        \begin{eqnarray*}
            \mathbf{u}^m \cdot \mathbf{n}^m &=& 0 \qquad \textrm{ on } \Gamma_N^m \\
            h^m &=& h^m_D \qquad \textrm{ on } \Gamma_D^m \\
            \mathbf{u}^m \cdot \mathbf{n}^m &=& \sigma^m_w \left(h^m-H^m_w\right) \textrm{ on } \Gamma^m_T \\
        \end{eqnarray*}
    
        well edges boundary:
        \[ \Gamma^m_T=\bigcup \limits _{w=1}^{W} \partial{}B^m_w \]
        
    \end{columns}
\end{frame}


\begin{frame}
  \frametitle{Communication among wells and aquifers}
  \begin{columns}
    \column{0.5\textwidth}
        \begin{equation}
        \color{red}{ Q^m_w = Q^m_{w,in} - Q^m_{w,out} }
        \end{equation}
        \vspace{-10pt}
        \begin{eqnarray*}
            Q^m_w &=& \textrm{flow into aquifer} \nonumber\\
            Q^m_{w,in} &=& \textrm{flow from upper aquifer} \nonumber\\
            Q^m_{w,out} &=& \textrm{flow into lower aquifer} \nonumber
        \end{eqnarray*}
    \begin{eqnarray*}
      Q^m_w &=& -\int_{\partial{}B^m_w}\sigma^m_w \left( h^m(\mathbf{x})-H^m_w          \right) \mathrm{d}\mathbf{x} \\
      Q^m_{w,in} &=& -c^{m+1}_w \left( H^m_w-H^{m+1}_w \right) \\
      Q^m_{w,out} &=& -c^m_w \left( H^{m-1}_w-H^{m}_w \right) 
    \end{eqnarray*}
    \begin{center}
      \framebox{\color{red}{we are looking for $(h^m,H^m_w)$}}
    \end{center}
    \column{0.48\textwidth}
        \begin{figure}
        \vspace{-15pt}
        \begin{center} \label{fig:well}        
          \def\svgwidth{0.92\textwidth}
          \input{\figpath well_communcation.pdf_tex}
        \end{center}
    \end{figure}
    \end{columns}
\end{frame}


\section{Partition of Unity Methods}

\begin{frame}
  \frametitle{Compared methods}
  \begin{enumerate}
    \setlength{\itemsep}{15pt}
    \item h-adaptive linear finite element method (FEM)  
    \item corrected XFEM -- eXtended FEM (implementing ramp function)
    \item corrected XFEM (implementing both ramp function and shift)
    \item SGFEM (Stable Generalized FEM)
  \end{enumerate}
  
  \vspace{15pt}
  \begin{itemize}
    \item implementation done with {\bf deal.II} \newline
          (C++ library, no enrichment technique support sofar,  quadrilateral cells)
  \end{itemize}
\end{frame}


\begin{frame}
  \frametitle{Enrichment function}
  \vspace{-20pt}
  \begin{columns}[t]
    \begin{column}{0.48\textwidth}
    \begin{equation*}
      s_w(\mathbf{x}) = 
        \begin{cases}
          \log(r_w(\mathbf{x})), & r_w > R_w\\
          \log(R_w), & r_w \le R_w\\
        \end{cases}
    \end{equation*}
    %
    \begin{multline*}
      r_w(\mathbf{x}) = \|\mathbf{x} - \xi_w\|= \\ 
      \sqrt{(x-x_w)^2+(y-y_w)^2}
    \end{multline*}
    %
    \end{column}
    \begin{column}{0.45\textwidth}
      \begin{figure}[!htb]
        %\vspace{0pt}
        \begin{center}        
          \def\svgwidth{\textwidth}
          \input{\figpath enrich_func.pdf_tex}
        \end{center}
        %\vspace{0pt}
      \end{figure}
    \end{column}
  \end{columns}
  
  \vspace{20pt}
  \begin{minipage}{\linewidth}
  \begin{itemize}
  \item index set for nodes inside an enriched area:
    \begin{equation*}
      \mathcal{N}_w = \{k \in \mathbb{N}:\, \|\mathbf{x}_k-\xi_w\| \leq r_{enr}\}, \qquad \mathbf{x}_k \textrm{ is a node of the triangulation}
    \end{equation*}
  
  \item solution of pressure with a single local enrichment (standard XFEM):
    \begin{equation*}
      h(\mathbf{x})= \underbrace{\sum \limits_{j\in\mathcal{N}}\alpha_j \, \phi_j(\mathbf{x})}_{\textrm{FEM}} 
      + \underbrace{ \sum \limits_{k\in\mathcal{N}_w} \beta_{k} \,\phi_k(\mathbf{x})\, s(\mathbf{x}) }_{\textrm{enrichment}}
    \end{equation*}

  \end{itemize}
  \end{minipage}
\end{frame}

\begin{frame}
  \frametitle{corrected XFEM -- ramp function}
  \begin{overlayarea}{\textwidth}{11.5cm}
    {\color{red}ramp function} $g(\mathbf{x}) = \sum \limits_{u\in\mathcal{N}} q_u \phi_u(\mathbf{x}) \quad q_u \in \{0,1\}$
    
    \vspace{3pt}
    \only<1>
    {
    pressure in the aquifer:
    \begin{equation*}
      h(\mathbf{x})=\sum \limits_{j\in\mathcal{N}}\alpha_j \, \phi_j(\mathbf{x}) + \sum \limits_{k\in\mathcal{N}_w} \beta_{k}  \, \phi_k(\mathbf{x}) \, \rul{red}{g(\mathbf{x})} \, s(\mathbf{x})
      %h^m(\mathbf{x})=\sum \limits_{j\in\mathcal{N}}\alpha^m_j \, \phi^m_j(\mathbf{x}) + \sum \limits_{w\in\mathcal{W}} \sum \limits_{k\in\mathcal{N}_w} \beta^m_{w,k}  \, \phi^m_k(\mathbf{x}) \, \rul{red}{g_w^m(\mathbf{x})} \, s_w^m(\mathbf{x})
      %\vspace{-10pt}
    \end{equation*}
    }
    \only<2>
    {
    pressure in $m$-th aquifer with multiple wells:
    \begin{equation*}
      %h(\mathbf{x})=\sum \limits_{j\in\mathcal{N}}\alpha_j \, \phi_j(\mathbf{x}) + \sum \limits_{k\in\mathcal{N}_w} \beta_{k}  \, \phi_k(\mathbf{x}) \, \rul{red}{g(\mathbf{x})} \, s(\mathbf{x})
      %h^m(\mathbf{x})=\sum \limits_{j\in\mathcal{N}}\alpha^m_j \, \phi^m_j(\mathbf{x}) + \sum \limits_{w\in\mathcal{W}} \sum \limits_{k\in\mathcal{N}_w} \beta^m_{w,k}  \, \phi^m_k(\mathbf{x}) \, \rul{red}{g_w^m(\mathbf{x})} \, s_w^m(\mathbf{x})
      h^{{\color{mycolor}m}}(\mathbf{x})=\sum \limits_{j\in\mathcal{N}}\alpha^{{\color{mycolor}{m}}}_j \, \phi^{{\color{mycolor}m}}_j(\mathbf{x}) 
        + {\color{mycolor} \sum \limits_{w\in\mathcal{W}}} \sum \limits_{k\in\mathcal{N}_w} \beta^{{\color{mycolor}m}}_{{\color{mycolor}w},k}  
        \, \phi^{{\color{mycolor}m}}_k(\mathbf{x}) \, \rul{red}{g_{{\color{mycolor}w}}^{{\color{mycolor}m}}(\mathbf{x})} \, s_{{\color{mycolor}w}}^{\color{mycolor}m}(\mathbf{x})
      %\vspace{-10pt}
    \end{equation*}
    }
    \vspace{-0.8cm} 
    \begin{figure}
      \centering
      \includegraphics[width=\textwidth]{\results xfem_ramp_bc_line_plot.pdf}
    \end{figure}
  \end{overlayarea}
\end{frame}


\begin{frame}
  \frametitle{corrected XFEM -- ramp function, shift}
    both {\color{red}ramp function} and {\color{blue}shift}
    
    %pressure in $m$-th aquifer:
    pressure in the aquifer:
    \begin{equation*}
      h(\mathbf{x})=\sum \limits_{j\in\mathcal{N}}\alpha_j \, \phi_j(\mathbf{x}) + \sum \limits_{k\in\mathcal{N}_w} \beta_{k}  \, \phi_k(\mathbf{x}) \, \rul{red}{g(\mathbf{x})} \, \rul{blue}{\big[s(\mathbf{x}) - s(\mathbf{x_k})\big]}
      %h^m(\mathbf{x})=\sum \limits_{j\in\mathcal{N}}\alpha^m_j \, \phi^m_j(\mathbf{x}) + \sum \limits_{w\in\mathcal{W}} \sum \limits_{k\in\mathcal{N}_w} \beta^m_{w,k}  \, \phi^m_k(\mathbf{x}) \, \rul{red}{g_w^m(\mathbf{x})} \, \rul{blue}{(s_w^m(\mathbf{x}) - s_w^m(\mathbf{x_k}))}
      %\vspace{-10pt}
    \end{equation*}
    \vspace{-15pt} 
    \begin{figure}
      \centering
      \includegraphics[width=\textwidth]{\results xfem_bc_line_plot.pdf}
    \end{figure}
\end{frame}

\begin{frame}
  \frametitle{SGFEM}
    {\color{blue}piecewise linear finite element interpolant} $\mathcal{I}(s)(\mathbf{x}) = \sum \limits_{u\in\mathcal{N}} \phi_u(\mathbf{x}) s(\mathbf{x}_u)$
    
    pressure in the aquifer:
    pressure in $m$-th aquifer:
    \begin{equation*}
      h(\mathbf{x})=\sum \limits_{j\in\mathcal{N}}\alpha_j \, \phi_j(\mathbf{x}) + \sum \limits_{k\in\mathcal{N}_w} \beta_{k}  \, \phi_k(\mathbf{x}) \, \rul{blue}{\big[s(\mathbf{x}) - \mathcal{I}(s)(\mathbf{x})\big]}
      %h^m(\mathbf{x})=\sum \limits_{j\in\mathcal{N}}\alpha^m_j \, \phi^m_j(\mathbf{x}) + \sum \limits_{w\in\mathcal{W}} \sum \limits_{k\in\mathcal{N}_w} \beta^m_{w,k}  \, \phi^m_k(\mathbf{x}) \, \rul{blue}{(s_w^m(\mathbf{x}) - \mathcal{I}(s_w^m)(\mathbf{x}))}
      %\vspace{-10pt}
    \end{equation*}
    \vspace{-15pt} 
    \begin{figure}
      \centering
      \includegraphics[width=\textwidth]{\results sgfem_bc_line_plot.pdf}
    \end{figure}
\end{frame}

\begin{frame}
  \frametitle{Adaptive integration on enriched cells}
  \begin{itemize}
    \item higher order quadrature on cells without a well
    \item adaptive element refinement on cells with a well
    \item fixed number of refinements (12 chosen)
  \end{itemize}
  \centering
  \begin{figure}[!htb]
    \centering    
    \subfloat[refined element with a well inside]{
      \includegraphics[width=0.45\textwidth]{\figpath adaptive_ref.pdf} }
    \hspace{10pt}
    \subfloat[detail of a well edge]{
      \includegraphics[width=0.45\textwidth]{\figpath adaptive_ref_detail.pdf} }
  \end{figure}
\end{frame}


\section{Current results}
% \begin{frame}
%   \frametitle{XFEM solution on circle mesh}
%   \vspace{0pt}
%   \begin{figure}
%     \centering
%     \includegraphics[width=0.95\textwidth]{\figpath circle_solution.pdf}
%   \end{figure}
% \end{frame}

\begin{frame}[c]
  \frametitle{Convergence of methods}
  
  \vspace{10pt}   
  \hspace{-15pt}
  \begin{minipage}{0.8\linewidth}
    \includegraphics[width=1.1\linewidth]{\results convergence_graph.pdf}
  \end{minipage}
  \hspace{-5pt}
  \begin{minipage}{0.23\linewidth}
    \vspace{-30pt}  
%     \tiny
%     N -- number of degrees of freedom
% 
%     \vspace{-15pt}
%     \setlength{\tabcolsep}{0.2em}
%     \renewcommand*{\arraystretch}{1.3}
%     \input{\figpath table_circle.tex}
% 
%     \vspace{-5pt}

    \small
    \begin{tabular} { >{\color{white}}m{0.83cm} >{\color{white}}m{1.32cm} @{}m{0pt}@{}}
      \rowcolor{NavyBlue} FEM & $O(h^{0.37})$ &\\ [2ex]
      \rowcolor{Purple} FEM adapt. & $O(h^{0.42})$ &\\ [2ex]
      \rowcolor{PineGreen} XFEM ramp  & $O(h^{1.71})$ &\\ [2ex]
      \rowcolor{Maroon} XFEM ramp, shift & $O(h^{1.76})$ &\\ [2ex]
      \rowcolor{Orange} SGFEM  & $O(h^{1.79})$ &\\ [2ex]
    \end{tabular}
%     \begin{tabular} {>{\color{gray}}c}
%       $O(h^{0.4})$ \\ [1ex]
%       $O(h^{1.8})$ \\ [1ex]
%     \end{tabular}
  \end{minipage}
\end{frame}

\begin{frame}
  \frametitle{Error distribution in SGFEM}
  \centering
  \includegraphics[width=0.9\textwidth]{\results sgfem_bc_line_plot_error.pdf}
  %\vspace{5pt}
  
  %\centering
  %\includegraphics[height=0.49\textheight, width=0.7\textwidth]{\figpath xfem_bc_line_plot_error.pdf}
\end{frame}


\begin{frame}[c]
  \frametitle{Solving linear system with CG}
  \begin{table}
    \centering
    \small
    %\begin{tabular} { >{\color{black}}m{2.0cm} | *3{>{\color{black}}m{1.3cm}} | >{\color{black}}m{2.0cm} }
    \begin{tabular} { >{\color{black}}m{2.0cm} *2{>{\color{black}}m{1.3cm}} | >{\color{black}}m{1.3cm}  >{\color{black}}m{2.0cm} }
      \toprule
       \multicolumn{5}{c}{number of CG iterations} \\
      \toprule 
         DoFs \newline(enriched) &XFEM \newline ramp & XFEM \newline ramp, shift & SGFEM & DoFs \newline(enriched)\\ \toprule
         18    (9)   & 16   & 13   & 6   & 10    (1)    \\ \hline
         34    (9)   & 26   & 19   & 12  & 26    (1)    \\ \hline
         106   (25)  & 74   & 42   & 29  & 90    (9)    \\ \hline
         358   (69)  & 246  & 82   & 58  & 326   (37)   \\ \hline
         1274  (185) & 959  & 155  & 118 & 1218  (129)  \\ \hline
         4838  (613) &  *   & 286  & 239 & 4734  (509)  \\ \hline
         18910 (2269)&  *   & 567  & 488 & 18702 (2061) \\ \bottomrule 
    \end{tabular}
  \end{table}
  
  -- CG tolerance set $10^{-12}$, Jacobi preconditioner applied \newline
  * did not converged after 4000 iterations.
  
%   \begin{columns}
%     \begin{column}{0.48\textwidth}
%       \small
%       \begin{tabular} { *4{>{\color{black}}m{1.0cm}} }
%         \toprule
%         \multicolumn{4}{c}{number of CG iterations} \\
%         \toprule 
%         FEM & XFEM & corr. XFEM & SGFEM \\ \toprule
%         & 16   & 13   & 6     \\ \hline
%         & 26   & 19   & 12    \\ \hline
%         & 74   & 42   & 29    \\ \hline
%         & 246  & 82   & 58    \\ \hline
%         & 959  & 155  & 118   \\ \hline
%         & --   & 286  & 239   \\ \hline
%         & --   & 567  & 488   \\ \bottomrule
%       \end{tabular}
%     \end{column}
%     
%     \begin{column}{0.48\textwidth}
%       \small
%       \begin{tabular} { *4{>{\color{black}}m{1.0cm}} }
%         \toprule
%         \multicolumn{4}{c}{condition number} \\
%         \toprule 
%         FEM & XFEM & corr. XFEM & SGFEM \\ \toprule
%         & 16   & 13   & 6     \\ \hline
%         & 26   & 19   & 12    \\ \hline
%         & 74   & 42   & 29    \\ \hline
%         & 246  & 82   & 58    \\ \hline
%         & 959  & 155  & 118   \\ \hline
%         & --   & 286  & 239   \\ \hline
%         & --   & 567  & 488   \\ \bottomrule
%       \end{tabular}
%     \end{column}
%   \end{columns}
  
  
\end{frame}


\section{Conclusion}

\begin{frame}
  \frametitle{Conlusion}
  \begin{itemize}
  \setlength{\itemsep}{10pt}
    \item logarithmic function can approximate point sources well
    \item corrected XFEM
      \begin{itemize}
        \item ramp function only -- convergence rate is lower, system matrix is worse conditioned
        \item ramp function and shift -- convergence is almost optimal \newline (in agreement with Gracie, Craig)
      \end{itemize}
    
    \item SGFEM
      \begin{itemize}
        \item linear system solved with less iterations than in XFEM case
        \item it is proved (by Babu\v ska and Banerjee) that the system matrix is not worse conditioned than the corresponding FEM matrix
        \item no more degrees of freedom on blending elements
      \end{itemize}
  \end{itemize}
\end{frame}

\section{Future research}
\begin{frame}
  \frametitle{Future research}
  
  \begin{itemize}
  \setlength{\itemsep}{8pt}
    \item choice of the enrichment radius
    \item improve the adaptive integration on enriched elements
    \item use more complicated model for convergence measurements
    \item deal with hanging nodes in the enriched area \newline
          \noindent\rule{\textwidth-1cm}{0.4pt}
    \item enrichment in mixed hybrid method
      \begin{itemize}
        \item enrichment only in pressure 
        \item enrichment both in pressure and velocity
      \end{itemize}
    \item implementation in Flow123d
    \item use enrichment to better approximate pressure and velocity near fractures
    \item non-compatible meshes, 3D-1D and 2D-1D connections
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Multiple wells problem}
  \vspace{-10pt}
 \begin{center}
  \begin{minipage}{\linewidth}
    \centering
    \includegraphics[width=0.90\linewidth]{\results sgfem_multiple_crop.pdf}
  \end{minipage}

  \begin{minipage}{\linewidth}
    \centering
    \includegraphics[width=0.398\linewidth]{\results fem_multiple_mesh_crop.pdf}
    \includegraphics[width=0.465\linewidth]{\results sgfem_multiple_mesh_crop.pdf} 
  \end{minipage}
 \end{center}
\end{frame}

\begin{frame}
\nocite{deal,mxfem,sgfem,gracie,dip}
  \scriptsize
  \frametitle{References}
  \renewcommand{\refname}{}
  \bibliographystyle{alpha}
  \bibliography{../citace}
\end{frame}

\begin{frame}
  \frametitle{}
  
  % {\bf Acknowledgement:} This work has been supported by the 
  % Technology Agency of the Czech Republic under the project no. TA01021331.
  
  \vspace{2cm}
  
  \centering
  Thank You for Your attention.
  
  
\end{frame}


% \begin{frame}
%   \frametitle{Pøedstava vrtù jako ploných zdrojù}
%   Zmìna toku pøes hranici za tok pøes plochu:
%   \begin{equation*}
%        -\int_{\color{red}{\partial{}B^m_w}}\sigma^m_w \left( h^m(\mathbf{x})-H^m_w \right) \mathrm{d}\mathbf{x} \quad \rightarrow \quad -\int_{\color{red}{B^m_w}}\eta^m_w \left( h^m(\mathbf{x})-H^m_w \right) \mathrm{d}\mathbf{x}
%   \end{equation*}
%   
%   Dosazení za zdrojový èlen $f$:
%   \begin{equation*}
%        -T^m \Delta h^m = -\int_{B^m_w}\eta^m_w \left( h^m(\mathbf{x})-H^m_w \right) \mathrm{d}\mathbf{x}
%   \end{equation*}
% 
%   Výhodou je zjednoduená asemblace a potenciál ke zkrácení výpoètu.
% \end{frame}



\end{document}